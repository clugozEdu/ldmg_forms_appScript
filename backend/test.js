// object to new form
// const formDepartmentID = newFormInfos.formDepartmentId;
// const title = newFormInfos.title;
// const description = newFormInfos.description;

// object to update form
// const formID = formInfos.formId;
// const formDepartmentID = formInfos.formDepartmentId;
// const title = formInfos.title;
// const description = formInfos.description;

// object to new step
// const formID = newStepInfos.mySQLFormId;
// const title = newStepInfos.title;
// const description = newStepInfos.description;
// const order = newStepInfos.stepCode;
// const type = newStepInfos.type;
// const action = newStepInfos.action;
// const question = newStepInfos.question;
// const answerType = newStepInfos.answerType;
// const answer1 = newStepInfos.answer1;
// const answer2 = newStepInfos.answer2;
// const answer3 = newStepInfos.answer3;
// const answer4 = newStepInfos.answer4;
// const photo1 = newStepInfos.photo1;
// const photo2 = newStepInfos.photo2;
// const photo3 = newStepInfos.photo3;
// const video1 = newStepInfos.video1;
// const video2 = newStepInfos.video2;
// const video3 = newStepInfos.video3;
// const status = newStepInfos.status;
// const checked = newStepInfos.checked;
// const background = newStepInfos.background;

[
  {
    departament: "Purchasing properties (for own and others)",
    departamentId: "120 Prop Purchasing properties (for own and others)",
    idMysql: 120,
  },
  {
    departament: "Disposing Properties",
    departamentId: "121 Prop Disposing Properties",
    idMysql: 121,
  },
  {
    departament: "Property certificates management",
    departamentId: "150 Cert Property certificates management",
    idMysql: 150,
  },
  {
    departament: "Planning (Customer Works)",
    departamentId: "440 PL Planning (Customer Works)",
    idMysql: 15061,
  },
  {
    departament: "Property Inventory: Locks and Keys management",
    departamentId: "161 Lock Property Inventory: Locks and Keys management",
    idMysql: 161,
  },
  {
    departament: "Property Inventory: Appliances",
    departamentId: "162 App Property Inventory: Appliances",
    idMysql: 162,
  },
  {
    departament: "Property Inventory: Furniture/Fitting and fixture",
    departamentId:
      "163 ProInv Property Inventory: Furniture/Fitting and fixture",
    idMysql: 163,
  },
  {
    departament: "Office-based asset management",
    departamentId: "191 OffInv Office-based asset management",
    idMysql: 191,
  },
  {
    departament: "General Operations",
    departamentId: "900 GenOp General Operations",
    idMysql: "19c6ba50",
  },
  {
    departament: "Property Emergency Insurance claims management",
    departamentId:
      "474 InsClaim Property Emergency Insurance claims management",
    idMysql: "1apmm5tn6j5ldkoehpg79eh7jo",
  },
  {
    departament: "Book-keeping",
    departamentId: "211 AccBook Book-keeping",
    idMysql: 211,
  },
  {
    departament: "HMRC, VAT works",
    departamentId: "222 HmrcVat HMRC, VAT works",
    idMysql: 222,
  },
  {
    departament: "HMRC, Companies House, Corporation Tax Works",
    departamentId: "223 HmrcCor HMRC, Companies House, Corporation Tax Works",
    idMysql: 223,
  },
  {
    departament: "HMRC, PAYE Works",
    departamentId: "224 HmrcPay HMRC, PAYE Works",
    idMysql: 224,
  },
  {
    departament: "Self Assessment Works",
    departamentId: "225 SelfAss Self Assessment Works",
    idMysql: 225,
  },
  {
    departament: "Customer Works Credit Control (non Tenant)",
    departamentId: "231 CWMon Customer Works Credit Control (non Tenant)",
    idMysql: 231,
  },
  {
    departament: "Customer Work Credit Control (Tenant), Rent Chase",
    departamentId:
      "232 TenMon Customer Work Credit Control (Tenant), Rent Chase",
    idMysql: 232,
  },
  {
    departament: "Supplier Works: Property Utility Accounts",
    departamentId: "600 SW Supplier Works: Property Utility Accounts",
    idMysql: "252qf3aveqv4hihpjhbtvu3spg",
  },
  {
    departament: "BPP, Tort Law L5 module",
    departamentId: "1404 BPP BPP, Tort Law L5 module",
    idMysql: "2bke67objgrtvhbqh2heoek06k",
  },
  {
    departament: "HR: Attedance and Absences",
    departamentId: "301 HrAtt HR: Attedance and Absences",
    idMysql: 301,
  },
  {
    departament: "HR: Recuritment",
    departamentId: "302 HrHire HR: Recuritment",
    idMysql: 302,
  },
  {
    departament: "HR: Colleagues disciplinary and grievances, leaving",
    departamentId:
      "303 HrDisc HR: Colleagues disciplinary and grievances, leaving",
    idMysql: 303,
  },
  {
    departament: "Systematisation, Delegations",
    departamentId: "310 System Systematisation, Delegations",
    idMysql: 310,
  },
  {
    departament: "HMO Licences (Customer Works)",
    departamentId: "431 LI HMO Licences (Customer Works)",
    idMysql: 431,
  },
  {
    departament: "Premises Licence (Customer Works)",
    departamentId: "433 LiPrem Premises Licence (Customer Works)",
    idMysql: 433,
  },
  {
    departament: "HR: Colleagues Starting",
    departamentId: "304 HrStar HR: Colleagues Starting",
    idMysql: "436182MS",
  },
  {
    departament: "Leases Works (Customer Works)",
    departamentId: "453 LEASE Leases Works (Customer Works)",
    idMysql: 453,
  },
  {
    departament: "Partywall Works (Customer Works)",
    departamentId: "457 PWall Partywall Works (Customer Works)",
    idMysql: 457,
  },
  {
    departament: "Business Rating Works (Customer Works)",
    departamentId: "461 BusRate Business Rating Works (Customer Works)",
    idMysql: 461,
  },
  {
    departament: "Site based asset/tool management",
    departamentId: "473 BUILD Site based asset/tool management",
    idMysql: 473,
  },
  {
    departament: "Property Letting",
    departamentId: "480 LET Property Letting",
    idMysql: 480,
  },
  {
    departament: "IT and Automation",
    departamentId: "330 IT IT and Automation",
    idMysql: 51217,
  },
  {
    departament: "Tenancy renewal",
    departamentId: "513 TenRenew Tenancy renewal",
    idMysql: 513,
  },
  {
    departament: "Tenant Moving Out",
    departamentId: "514 TenOut Tenant Moving Out",
    idMysql: 514,
  },
  {
    departament: "Design, Measurement Survey and Draughting (Customer Works)",
    departamentId:
      "410 DR Design, Measurement Survey and Draughting (Customer Works)",
    idMysql: 52183,
  },
  {
    departament: "Alcohol Licences (Customer Works)",
    departamentId: "432 LI Alcohol Licences (Customer Works)",
    idMysql: 580088,
  },
  {
    departament: "Structural Engineering (Customer Works)",
    departamentId: "421 SE Structural Engineering (Customer Works)",
    idMysql: "58008MS",
  },
  {
    departament: "Supplier Works (non utilty accounts)",
    departamentId: "630 SW Supplier Works (non utilty accounts)",
    idMysql: 630,
  },
  {
    departament: "Building Control (Customer Works)",
    departamentId: "420 BC Building Control (Customer Works)",
    idMysql: 63321,
  },
  {
    departament: "Companies House Works",
    departamentId: "226 CH Companies House Works",
    idMysql: "7213bb45",
  },
  {
    departament: "Property Build (Construction Project Management CPM)",
    departamentId:
      "470 BUILD Property Build (Construction Project Management CPM)",
    idMysql: 72503,
  },
  {
    departament: "Workflow Management (cnb)",
    departamentId: "320 WorkFlo Workflow Management (cnb)",
    idMysql: 73499,
  },
  {
    departament: "Customer Works",
    departamentId: "400 CW Customer Works",
    idMysql: 734999,
  },
  {
    departament: "Tenant Evictions",
    departamentId: "452 TE Tenant Evictions",
    idMysql: 85133,
  },
  {
    departament: "Supplier Works: Vehicle related",
    departamentId: "610 SW Supplier Works: Vehicle related",
    idMysql: "91b3b813",
  },
  {
    departament: "Tenant Incidents",
    departamentId: "526 TenInc Tenant Incidents",
    idMysql: "966fe13c",
  },
  {
    departament: "Tenants and Customer Deposit/Funds management",
    departamentId: "233 TenDep Tenants and Customer Deposit/Funds management",
    idMysql: "ca6bfd66",
  },
  {
    departament: "Tenant Moving In",
    departamentId: "511 TenIn Tenant Moving In",
    idMysql: "d79e29ad",
  },
  {
    departament: "Sales and Marketing",
    departamentId: "700 Sales Sales and Marketing",
    idMysql: "dgeshgpidtvpbvcgiunual4l6g",
  },
  {
    departament:
      "BPP, PPS Professional Practice Skills module (ends in May 2023)",
    departamentId:
      "1402 BPP BPP, PPS Professional Practice Skills module (ends in May 2023)",
    idMysql: "g1bq1o1tkriv41votpdk4uq1n8",
  },
  {
    departament: "Directorship and Growth",
    departamentId: "350 Direct Directorship and Growth",
    idMysql: "igdufl3dvhogs3102eo3moct7c",
  },
  {
    departament: "Property Surveys and Reports",
    departamentId: "490 BS Property Surveys and Reports",
    idMysql: "jk1tu67hnpecehbgs0hsqner2g",
  },
  {
    departament: "BPP, Law/Legal Learning and Qualification",
    departamentId: "1401 BPP BPP, Law/Legal Learning and Qualification",
    idMysql: "k4nersoqecj85dl6tk1ed4h534",
  },
  {
    departament: "BPP, Portfolio Module (should end in May 2023)",
    departamentId: "1403 BPP BPP, Portfolio Module (should end in May 2023)",
    idMysql: "lhj0khukemorfkpoat5ifjphg8",
  },
  {
    departament: "UCLAN, Building Surveying Learning, RICS Qualification",
    departamentId:
      "1500 UCLAN UCLAN, Building Surveying Learning, RICS Qualification",
    idMysql: "lut50493r0vbd6ebqihu2gs77g",
  },
  {
    departament: "UClan - Contract Administration",
    departamentId: "1501 UCLAN UClan - Contract Administration",
    idMysql: "mbib30kfp1j725nfimki8adtb8",
  },
  {
    departament: "Building Insurance, Landlord emergency insurance Works",
    departamentId:
      "640 Ins Building Insurance, Landlord emergency insurance Works",
    idMysql: "nt476b0g488utlf09tj5cb701o",
  },
];

{
  formDepartmentID: 51217;
  formDepartmentTitle: "IT and Automation";
  formDeptID: "330 IT IT and Automation";
  formDeptShortname: "IT";
  formDescription: "Need to use San's Admin Profile \n\n1. Go to Apps > Googlw Workspace > Drive and Docs \n2. Click Transfer Ownership \n3. From User (Email address of persons drive is being transfered from)\n4. To User (Email address of new owner which are being transfered to)\n5. Click Transfer Files";
  formId: "330 How to transfer ownership of Google Drive";
  mySQLId: "00fe8fdd";
}

const t = [
  {
    formId: "00fe8fdd",
    formDepartmentId: 51217,
    description:
      "Need to use San's Admin Profile \n\n1. Go to Apps > Googlw Workspace > Drive and Docs \n2. Click Transfer Ownership \n3. From User (Email address of persons drive is being transfered from)\n4. To User (Email address of new owner which are being transfered to)\n5. Click Transfer Files",
    title: "330 How to transfer ownership of Google Drive",
  },
];

const setCellStyles = (cell, maxWidth) => {
  cell.style.maxWidth = maxWidth;
  cell.style.overflow = "hidden";
  cell.style.whiteSpace = "normal";
};

const createTableCell = (maxWidth, textContent = "") => {
  const cell = document.createElement("td");
  setCellStyles(cell, maxWidth);
  cell.textContent = textContent;
  return cell;
};

const createButton = (classes, iconClass, text = "") => {
  const button = document.createElement("button");
  button.classList.add("btn", ...classes);
  button.innerHTML = `<i class="${iconClass}" aria-hidden="true"></i> ${text}`;
  button.style.marginRight = "2px";
  return button;
};

const createDataTable = (formsObject) => {
  table.innerHTML = "";

  formsObject.forEach((form) => {
    const row = document.createElement("tr");

    const formIdDepartament = createTableCell("70px", form.formDepartmentID);
    const formIdCell = createTableCell("220px", form.formId);

    const maxDescriptionLength = 80;
    const truncatedDescription =
      form.formDescription.slice(0, maxDescriptionLength) + "...";
    const formDescriptionCell = createTableCell("350px", truncatedDescription);

    const formActionsCell = createTableCell("180px");

    const buttonContainer = document.createElement("div");
    buttonContainer.style.display = "flex";

    const expandButton = createButton(["btn-info"], "fa fa-chevron-down");
    expandButton.addEventListener("click", () => {
      formDescriptionCell.textContent = form.formDescription;
      expandButton.style.display = "none";
      collapseButton.style.display = "block";
    });

    const collapseButton = createButton(["btn-info"], "fa-solid fa-chevron-up");
    collapseButton.style.display = "none";
    collapseButton.addEventListener("click", () => {
      formDescriptionCell.textContent = truncatedDescription;
      collapseButton.style.display = "none";
      expandButton.style.display = "block";
    });

    const editButton = createButton(
      ["btn-success", "btn-edit"],
      "fa-solid fa-edit",
      "Edit"
    );
    editButton.dataset.id = form.mySQLId;

    const selectButton = createButton(
      ["btn-primary", "btn-select"],
      "fa-regular fa-circle-check",
      "Select"
    );

    [expandButton, collapseButton, editButton, selectButton].forEach((btn) =>
      buttonContainer.appendChild(btn)
    );
    formActionsCell.appendChild(buttonContainer);

    [
      formIdDepartament,
      formIdCell,
      formDescriptionCell,
      formActionsCell,
    ].forEach((cell) => row.appendChild(cell));

    table.appendChild(row);
  });

  initEventRefresh();
  initEventButtonEdit();
  initEventButtonSelect();
  hiddenLoading();
};
