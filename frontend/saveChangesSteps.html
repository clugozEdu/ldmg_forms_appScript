<script>
  document.addEventListener("click", function (event) {
    if (event.target.matches("#save-forms-allStep")) {
      stepNewObject.forEach((step) => {
        delete step.originalCode;
      });

      swalWithBootstrapButtons
        .fire({
          title: "Are you sure?",
          icon: "warning",
          showCancelButton: true,
          confirmButtonText: "Yes, saved changes!",
          cancelButtonText: "No, cancel!",
        })
        .then((result) => {
          if (result.isConfirmed) {
            if (stepsEditObject.length > 0) {
              google.script.run
                .withSuccessHandler()
                .updateSteps(stepsEditObject);
            }

            if (stepNewObject.length > 0) {
              google.script.run
                .withSuccessHandler((data) => {
                  window.alert(data);
                })
                .addNewSteps(stepNewObject);
            }

            if (arrayDeleteStep.length > 0) {
              google.script.run
                .withSuccessHandler()
                .deleteSteps(arrayDeleteStep);
            }

            if (arrayCodeModified.length > 0) {
              google.script.run
                .withSuccessHandler()
                .stepsOrderMaker(arrayCodeModified);
            }

            setTimeout(loadForms(), 3000);
          }
        });
    }
  });
</script>
